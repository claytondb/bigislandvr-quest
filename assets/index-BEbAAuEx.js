import{S as b,W as k,a as x,C as S,P as H,b as K,M as T,B as L,c as P,V as g,d as w,e as y,f as E}from"./three-DmyX0QsJ.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const t of i)if(t.type==="childList")for(const s of t.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&e(s)}).observe(document,{childList:!0,subtree:!0});function a(i){const t={};return i.integrity&&(t.integrity=i.integrity),i.referrerPolicy&&(t.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?t.credentials="include":i.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function e(i){if(i.ep)return;i.ep=!0;const t=a(i);fetch(i.href,t)}})();class h{static createButton(o,a={}){const e=document.createElement("button");function i(){let n=null;async function u(l){l.addEventListener("end",m),await o.xr.setSession(l),e.textContent="EXIT VR",n=l}function m(){n.removeEventListener("end",m),e.textContent="ENTER VR",n=null}e.style.display="",e.style.cursor="pointer",e.style.left="calc(50% - 50px)",e.style.width="100px",e.textContent="ENTER VR";const d={...a,optionalFeatures:["local-floor","bounded-floor","layers",...a.optionalFeatures||[]]};e.onmouseenter=function(){e.style.opacity="1.0"},e.onmouseleave=function(){e.style.opacity="0.5"},e.onclick=function(){n===null?navigator.xr.requestSession("immersive-vr",d).then(u):(n.end(),navigator.xr.offerSession!==void 0&&navigator.xr.offerSession("immersive-vr",d).then(u).catch(l=>{console.warn(l)}))},navigator.xr.offerSession!==void 0&&navigator.xr.offerSession("immersive-vr",d).then(u).catch(l=>{console.warn(l)})}function t(){e.style.display="",e.style.cursor="auto",e.style.left="calc(50% - 75px)",e.style.width="150px",e.onmouseenter=null,e.onmouseleave=null,e.onclick=null}function s(){t(),e.textContent="VR NOT SUPPORTED"}function c(n){t(),console.warn("Exception when trying to call xr.isSessionSupported",n),e.textContent="VR NOT ALLOWED"}function r(n){n.style.position="absolute",n.style.bottom="20px",n.style.padding="12px 6px",n.style.border="1px solid #fff",n.style.borderRadius="4px",n.style.background="rgba(0,0,0,0.1)",n.style.color="#fff",n.style.font="normal 13px sans-serif",n.style.textAlign="center",n.style.opacity="0.5",n.style.outline="none",n.style.zIndex="999"}if("xr"in navigator)return e.id="VRButton",e.style.display="none",r(e),navigator.xr.isSessionSupported("immersive-vr").then(function(n){n?i():s(),n&&h.xrSessionIsGranted&&e.click()}).catch(c),e;{const n=document.createElement("a");return window.isSecureContext===!1?(n.href=document.location.href.replace(/^http:/,"https:"),n.innerHTML="WEBXR NEEDS HTTPS"):(n.href="https://immersiveweb.dev/",n.innerHTML="WEBXR NOT AVAILABLE"),n.style.left="calc(50% - 90px)",n.style.width="180px",n.style.textDecoration="none",r(n),n}}static registerSessionGrantedListener(){if(typeof navigator<"u"&&"xr"in navigator){if(/WebXRViewer\//i.test(navigator.userAgent))return;navigator.xr.addEventListener("sessiongranted",()=>{h.xrSessionIsGranted=!0})}}}h.xrSessionIsGranted=!1;h.registerSessionGrantedListener();const f=[{id:1,name:"Hilo Bayfront",desc:"Lili ªuokalani Park looking toward Coconut Island (Moku Ola)",region:"Hilo",lat:19.7235,lng:-155.072,heading:45,pitch:0,audio:{ocean:.8,birds:.5,wind:.2},atmosphere:{mist:!1,volcanic:!1},summary:"üèùÔ∏è Coconut Island (Moku Ola) was once a place of healing in ancient Hawaii. Queen Lili ªuokalani dedicated this park in 1917, featuring Japanese gardens that honor the 1960 tsunami victims."},{id:2,name:"Banyan Drive",desc:"Historic avenue lined with banyan trees planted by celebrities",region:"Hilo",lat:19.7235,lng:-155.0772,heading:180,pitch:0,audio:{ocean:.4,birds:.8,wind:.1},atmosphere:{mist:!1,volcanic:!1},summary:"üå≥ Each banyan tree was planted by a celebrity in the 1930s-1970s, including Babe Ruth, Amelia Earhart, and Franklin D. Roosevelt. The trees create a natural canopy over this historic shoreline drive."},{id:3,name:"Rainbow Falls Viewpoint",desc:"WaiƒÅnuenue ‚Äî iconic 80-foot waterfall just outside Hilo",region:"Hilo",lat:19.7189,lng:-155.1065,heading:270,pitch:-10,audio:{waterfall:.8,birds:.6,wind:.2},atmosphere:{mist:!0,volcanic:!1},summary:"üåà Named 'WaiƒÅnuenue' (rainbow water), morning sunlight creates rainbows in the mist. Legend says the cave behind the falls is home to Hina, goddess of the moon and mother of Maui."},{id:4,name:"Hilo Farmers Market",desc:"Vibrant outdoor market in downtown Hilo",region:"Hilo",lat:19.7244,lng:-155.0896,heading:90,pitch:0,audio:{birds:.3,wind:.1},atmosphere:{mist:!1,volcanic:!1},summary:"ü•≠ Operating since 1988, this market features 200+ local vendors selling tropical fruits, flowers, crafts, and fresh poke. It's the largest open-air market in Hawaii!"},{id:5,name:"Pepe ªekeo Scenic Drive",desc:"Lush 4-mile coastal road through tropical rainforest",region:"Hilo",lat:19.8345,lng:-155.1012,heading:45,pitch:0,audio:{birds:.9,wind:.3},atmosphere:{mist:!0,volcanic:!1},summary:"üåø This old highway winds through dense tropical jungle past one-lane bridges and small waterfalls. Once the main coastal route, it's now a peaceful detour showcasing Hawaii's rainforest beauty."},{id:6,name:"Akaka Falls State Park",desc:"Spectacular 442-foot waterfall in lush rainforest",region:"Hamakua",lat:19.8535,lng:-155.1527,heading:90,pitch:-5,audio:{waterfall:.9,birds:.7,wind:.2},atmosphere:{mist:!0,volcanic:!1},summary:"üíß At 442 feet, Akaka Falls plunges into a gorge surrounded by wild orchids, bamboo, and ferns. The name 'Akaka' means to crack or split, describing how the water breaks on the rocks below."},{id:7,name:"Waipi ªo Valley Lookout",desc:"Breathtaking viewpoint of the Valley of the Kings",region:"Hamakua",lat:20.1177,lng:-155.5868,heading:315,pitch:-10,audio:{wind:.6,birds:.5,ocean:.2},atmosphere:{mist:!1,volcanic:!1},summary:"üëë This sacred 'Valley of the Kings' was home to Hawaiian royalty. Once populated by 10,000+ people, it features a black sand beach and 1,300-foot cliffs. King Kamehameha spent his childhood here."},{id:8,name:"Honoka ªa Town",desc:"Historic sugar plantation town with vintage charm",region:"Hamakua",lat:20.0787,lng:-155.4678,heading:0,pitch:0,audio:{birds:.4,wind:.2},atmosphere:{mist:!1,volcanic:!1},summary:"üèöÔ∏è This 1880s sugar town has reinvented itself with antique shops, art galleries, and local eateries. The Honoka'a People's Theatre (1930) still shows films today."},{id:9,name:"LaupƒÅhoehoe Point",desc:"Dramatic coastline with powerful wave action",region:"Hamakua",lat:19.9907,lng:-155.2384,heading:45,pitch:0,audio:{ocean:.9,wind:.6},atmosphere:{mist:!0,volcanic:!1},summary:"üåä This lava peninsula was tragically struck by the 1946 tsunami, taking 24 lives including students and teachers. A memorial honors them today. The name means 'leaf of smooth lava.'"},{id:10,name:"Kea ªau Town Center",desc:"Small town gateway to the Puna district",region:"Puna",lat:19.6222,lng:-155.0386,heading:0,pitch:0,audio:{birds:.6,wind:.2},atmosphere:{mist:!1,volcanic:!1},summary:"üå∫ Gateway to the wild Puna district, Kea ªau sits at the edge of tropical farmland and ohia forests. The area is known for papaya farms and an independent, off-grid community spirit."},{id:11,name:"PƒÅhoa Village",desc:"Funky town with historic wooden boardwalk",region:"Puna",lat:19.4959,lng:-154.9437,heading:180,pitch:0,audio:{birds:.5,wind:.2},atmosphere:{mist:!1,volcanic:!1},summary:"üé® This bohemian village features an 1890s wooden boardwalk, eclectic shops, and resilient locals who survived the 2018 lava flows. The 'Wild West of Hawaii' keeps its counterculture vibe alive."},{id:12,name:"Volcano Village",desc:"Misty rainforest village near Kƒ´lauea",region:"Volcano",lat:19.4329,lng:-155.2339,heading:90,pitch:0,audio:{birds:.7,wind:.4,rain:.3},atmosphere:{mist:!0,volcanic:!1},summary:"üåßÔ∏è At 4,000 feet elevation, this misty village gets 140 inches of rain yearly. Artists and dreamers flock here for the cool climate and proximity to Kƒ´lauea's power."},{id:13,name:"Kƒ´lauea Visitor Center",desc:"Gateway to Hawai ªi Volcanoes National Park",region:"Volcano",lat:19.4313,lng:-155.257,heading:180,pitch:0,audio:{wind:.6,volcanic:.5},atmosphere:{mist:!0,volcanic:!0},summary:"üåã Hawai ªi Volcanoes National Park is home to Kƒ´lauea, one of Earth's most active volcanoes. Pele, the fire goddess, is said to live in Halema ªuma ªu crater. The park became a UNESCO World Heritage Site in 1987."},{id:14,name:"Kƒ´lauea Crater Rim",desc:"Dramatic views of the active Halema ªuma ªu crater",region:"Volcano",lat:19.4119,lng:-155.2833,heading:220,pitch:0,audio:{wind:.8,volcanic:.7},atmosphere:{mist:!0,volcanic:!0},summary:"üî• Halema ªuma ªu crater is the legendary home of Pele. The 2018 eruption dramatically changed this landscape, collapsing the crater floor and creating a new water lake‚Äîthe first in recorded history."},{id:15,name:"Chain of Craters Road",desc:"Scenic drive through lava fields to the coast",region:"Volcano",lat:19.3053,lng:-155.1014,heading:180,pitch:0,audio:{wind:.7,ocean:.3,volcanic:.2},atmosphere:{mist:!1,volcanic:!0},summary:"üõ£Ô∏è This 19-mile road descends 3,700 feet through multiple lava flows from 1969-1974. It ends abruptly where 2003 lava covered the old coastal highway, a powerful reminder of the land's constant transformation."},{id:16,name:"Thurston Lava Tube",desc:"Walk through a 500-year-old lava tube (NƒÅhuku)",region:"Volcano",lat:19.4145,lng:-155.2391,heading:90,pitch:0,audio:{birds:.8,wind:.1},atmosphere:{mist:!0,volcanic:!1},summary:"üï≥Ô∏è NƒÅhuku ('the protuberances') formed when the outer crust of a lava flow hardened while molten rock continued flowing inside. This 500-year-old tube is surrounded by native '≈çhi'a forest full of birdsong."},{id:17,name:"Punalu'u Black Sand Beach",desc:"Famous black sand beach where sea turtles rest",region:"Ka ª≈´",lat:19.1361,lng:-155.5044,heading:180,pitch:0,audio:{ocean:.9,wind:.4},atmosphere:{mist:!1,volcanic:!1},summary:"üê¢ This jet-black beach was created when hot lava shattered as it hit the ocean. Green sea turtles (honu) bask here daily‚Äîthey're protected, so keep your distance! Ancient heiau ruins dot the shoreline."},{id:18,name:"South Point (Ka Lae)",desc:"Southernmost point in the United States",region:"Ka ª≈´",lat:18.9108,lng:-155.6817,heading:180,pitch:0,audio:{wind:1,ocean:.6},atmosphere:{mist:!1,volcanic:!1},summary:"üß≠ Ka Lae is where Polynesian voyagers first landed in Hawaii around 400 AD. At 18.9¬∞ latitude, it's the southernmost point in the USA. The constant 30mph winds powered the rusty windmills you see today."},{id:19,name:"NƒÅ ªƒÅlehu Town",desc:"Southernmost town in the USA with local charm",region:"Ka ª≈´",lat:19.0625,lng:-155.5786,heading:90,pitch:0,audio:{birds:.3,wind:.2},atmosphere:{mist:!1,volcanic:!1},summary:"üá∫üá∏ America's southernmost town sits in the heart of Ka ª≈´ ranch country. The historic Punalu'u Bake Shop here is famous for its sweetbread, and Mark Twain once planted a monkey pod tree in town (it fell in 1957)."},{id:20,name:"Ali ªi Drive, Kailua-Kona",desc:"Historic oceanfront street in downtown Kona",region:"Kona",lat:19.64,lng:-155.9969,heading:270,pitch:0,audio:{ocean:.9,birds:.3,wind:.2},atmosphere:{mist:!1,volcanic:!1},summary:"üåÖ Named after the ali'i (royalty), this waterfront strip was where Hawaiian chiefs lived. The Ironman World Championship starts and ends here. Kona's dry climate creates legendary sunsets."},{id:21,name:"Kailua Pier",desc:"Historic pier and start of the Ironman triathlon",region:"Kona",lat:19.6393,lng:-155.9982,heading:270,pitch:0,audio:{ocean:.8,birds:.2},atmosphere:{mist:!1,volcanic:!1},summary:"üèä Every October, 2,500 triathletes dive off this pier to begin the Ironman World Championship. Originally built for interisland steamers in 1915, it's now the heart of Kona's waterfront activity."},{id:22,name:"Hulihe ªe Palace",desc:"Former vacation home of Hawaiian royalty",region:"Kona",lat:19.6398,lng:-155.995,heading:90,pitch:0,audio:{ocean:.6,birds:.4},atmosphere:{mist:!1,volcanic:!1},summary:"üëë Built in 1838, this palace served as a summer getaway for Hawaiian royalty. King KalƒÅkaua threw legendary parties here. Now a museum, it showcases the life of Hawaiian ali'i."},{id:23,name:"Captain Cook Monument Trail",desc:"Overlook of Kealakekua Bay",region:"Kona",lat:19.479,lng:-155.9312,heading:270,pitch:-5,audio:{ocean:.5,birds:.6,wind:.3},atmosphere:{mist:!1,volcanic:!1},summary:"‚öì Captain James Cook was killed here in 1779 during a confrontation with Hawaiians. The bay is now a marine sanctuary with pristine snorkeling. Spinner dolphins gather here most mornings."},{id:24,name:"Pu ªuhonua o H≈çnaunau",desc:"Place of Refuge National Historical Park",region:"Kona",lat:19.4225,lng:-155.9125,heading:270,pitch:0,audio:{ocean:.7,wind:.3},atmosphere:{mist:!1,volcanic:!1},summary:"üõ°Ô∏è In ancient Hawaii, those who broke kapu (sacred laws) faced death‚Äîunless they reached this sanctuary. Once here, a priest could absolve them. The massive stone wall dates to 1550 AD."},{id:25,name:"Kona Coffee Farm",desc:"Working coffee plantation in the Kona coffee belt",region:"Kona",lat:19.5125,lng:-155.92,heading:90,pitch:0,audio:{birds:.7,wind:.2},atmosphere:{mist:!1,volcanic:!1},summary:"‚òï The slopes of HualƒÅlai create perfect coffee-growing conditions: sunny mornings, cloudy afternoons, rich volcanic soil. Kona coffee is one of the most expensive in the world, hand-picked by local farmers."},{id:26,name:"Kohala Mountain Road",desc:"Scenic upcountry road with panoramic views",region:"Kohala",lat:20.075,lng:-155.785,heading:0,pitch:0,audio:{wind:.6,birds:.4},atmosphere:{mist:!1,volcanic:!1},summary:"üèîÔ∏è This winding road climbs through pastureland where paniolos (Hawaiian cowboys) still work today. On clear days, you can see Maui, HaleakalƒÅ, and the peaks of Mauna Kea and Mauna Loa."},{id:27,name:"HƒÅwƒ´ Town",desc:"Art galleries and cafes in old plantation town",region:"Kohala",lat:20.2412,lng:-155.834,heading:180,pitch:0,audio:{birds:.5,wind:.3},atmosphere:{mist:!1,volcanic:!1},summary:"üé≠ Once a bustling sugar town, HƒÅwƒ´ reinvented itself as an arts community when the plantation closed in 1975. The original wooden storefronts now house galleries, boutiques, and farm-to-table restaurants."},{id:28,name:"Pololu Valley Lookout",desc:"Dramatic overlook of pristine black sand beach",region:"Kohala",lat:20.206,lng:-155.7322,heading:0,pitch:-10,audio:{ocean:.6,wind:.7},atmosphere:{mist:!1,volcanic:!1},summary:"üñ§ This remote valley marks the end of the road in North Kohala. A steep trail leads down to a black sand beach where hala trees line the shore. It's the first of seven valleys stretching to Waipi'o."},{id:29,name:"King Kamehameha Statue",desc:"Original statue in Kapa ªau",region:"Kohala",lat:20.235,lng:-155.8012,heading:180,pitch:0,audio:{birds:.3,wind:.2},atmosphere:{mist:!1,volcanic:!1},summary:"üëë This is the ORIGINAL Kamehameha statue‚Äîthe one in Honolulu is a replica! The original sank at sea in 1880, was recovered, and placed here in Kohala where the great king was born around 1758."},{id:30,name:"Pu ªukoholƒÅ Heiau",desc:"Ancient temple built by King Kamehameha",region:"Kohala",lat:20.0267,lng:-155.8192,heading:270,pitch:0,audio:{ocean:.5,wind:.6},atmosphere:{mist:!1,volcanic:!1},summary:"‚õ©Ô∏è Kamehameha built this massive temple in 1790-91 to fulfill a prophecy that would help him conquer all of Hawaii. The heiau was constructed without mortar, using stones passed hand-to-hand for miles."},{id:31,name:"Hapuna Beach",desc:"One of Hawaii's finest white sand beaches",region:"Kohala",lat:19.9943,lng:-155.8277,heading:270,pitch:0,audio:{ocean:1,wind:.3},atmosphere:{mist:!1,volcanic:!1},summary:"üèñÔ∏è Consistently rated among the world's best beaches, Hapuna has half a mile of wide, white sand and crystal-clear water. The beach is a favorite for bodyboarding and swimming."},{id:32,name:"Mauna Kea Beach",desc:"Crescent beach at historic resort",region:"Kohala",lat:19.9638,lng:-155.8197,heading:270,pitch:0,audio:{ocean:.9,wind:.2},atmosphere:{mist:!1,volcanic:!1},summary:"üå¥ Kauna'oa Bay features a perfect crescent of white sand backed by the historic Mauna Kea Beach Hotel (1965). Sea turtles frequent the waters, and the resort was Rockefeller's vision of Hawaiian luxury."},{id:33,name:"Mauna Kea Summit Road",desc:"Road to the tallest mountain in Hawaii",region:"Hamakua",lat:19.76,lng:-155.46,heading:0,pitch:10,audio:{wind:.8},atmosphere:{mist:!1,volcanic:!1},summary:"üèîÔ∏è At 13,796 feet, Mauna Kea is Hawaii's tallest peak and a sacred site. The summit hosts world-class observatories due to the clear, dry air. In Hawaiian, 'Mauna Kea' means 'White Mountain' for its winter snows."},{id:34,name:"Waimea (Kamuela)",desc:"Historic paniolo (cowboy) town in the highlands",region:"Kohala",lat:20.0225,lng:-155.67,heading:90,pitch:0,audio:{wind:.4,birds:.3},atmosphere:{mist:!1,volcanic:!1},summary:"ü§† Hawaii's cowboy culture lives here! Parker Ranch, founded in 1847, was once the largest privately owned ranch in the US. At 2,670 feet elevation, Waimea has a cool, pastoral climate unlike anywhere else on the island."},{id:35,name:" ªAnaeho ªomalu Bay (A-Bay)",desc:"Palm-lined beach with ancient fishponds",region:"Kohala",lat:19.9222,lng:-155.8908,heading:270,pitch:0,audio:{ocean:.8,birds:.4},atmosphere:{mist:!1,volcanic:!1},summary:"üêü This bay's tongue-twisting name means 'protected mullet.' Ancient Hawaiians built fishponds here that you can still see today. The beach is perfect for sunset views and sea turtle spotting."}],A={Hilo:{name:"Hilo",description:"The rainy side with lush rainforests and waterfalls",color:"#2A9D8F"},Hamakua:{name:"Hamakua Coast",description:"Dramatic coastline with valleys and historic towns",color:"#4CAF50"},Puna:{name:"Puna",description:"Wild east side with bohemian villages and lava flows",color:"#E63946"},Volcano:{name:"Volcano",description:"Home to Kƒ´lauea and mystic rainforest",color:"#FF6B35"},Ka ª≈´:{name:"Ka ª≈´",description:"Remote southern district with black sand beaches",color:"#F4A261"},Kona:{name:"Kona",description:"Sunny coast with history and coffee farms",color:"#3DA5D9"},Kohala:{name:"Kohala",description:"Northern region with resorts and paniolo heritage",color:"#9B5DE5"}},C="AIzaSyBmSDHrsQunVjxhZ4UHQ0asdUY6vZVFszY",v=512,I={preview:{zoom:2,tilesX:4,tilesY:2,width:2048,height:1024},medium:{zoom:3,tilesX:8,tilesY:4,width:4096,height:2048}};class R{renderer;scene;camera;panoramaSphere;currentLocationIndex=0;isDragging=!1;previousMousePosition={x:0,y:0};spherical=new b(1,Math.PI/2,0);isLoading=!1;constructor(){console.log("üå¥ Big Island VR Quest starting...");const o=document.getElementById("canvas");this.renderer=new k({canvas:o,antialias:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.renderer.xr.enabled=!0,this.scene=new x,this.scene.background=new S(1731452),this.camera=new H(75,window.innerWidth/window.innerHeight,.1,1e3),this.camera.position.set(0,1.6,0);const a=new K(500,64,32);a.scale(-1,1,1);const e=new T({color:3355443,side:L});this.panoramaSphere=new P(a,e),this.scene.add(this.panoramaSphere),this.setupVR(),this.setupControls(),this.goToLocation(0);const i=document.getElementById("loading");i&&i.classList.add("hidden"),this.renderer.setAnimationLoop(()=>this.render()),console.log("‚úÖ App ready!")}setupVR(){"xr"in navigator&&navigator.xr.isSessionSupported("immersive-vr").then(o=>{if(o){document.body.appendChild(h.createButton(this.renderer));const a=document.getElementById("vr-button");a&&(a.removeAttribute("disabled"),a.textContent="ü•Ω Enter VR")}})}setupControls(){const o=this.renderer.domElement;o.addEventListener("mousedown",a=>{this.isDragging=!0,this.previousMousePosition={x:a.clientX,y:a.clientY}}),window.addEventListener("mouseup",()=>this.isDragging=!1),window.addEventListener("mousemove",a=>{if(!this.isDragging)return;const e=a.clientX-this.previousMousePosition.x,i=a.clientY-this.previousMousePosition.y;this.spherical.theta-=e*.005,this.spherical.phi=Math.max(.1,Math.min(Math.PI-.1,this.spherical.phi+i*.005)),this.camera.lookAt(new g().setFromSpherical(this.spherical)),this.previousMousePosition={x:a.clientX,y:a.clientY}}),o.addEventListener("wheel",a=>{this.camera.fov=Math.max(20,Math.min(100,this.camera.fov*(a.deltaY>0?1.1:.9))),this.camera.updateProjectionMatrix()}),window.addEventListener("keydown",a=>{this.isLoading||(a.key==="ArrowRight"?this.goToLocation((this.currentLocationIndex+1)%f.length):a.key==="ArrowLeft"&&this.goToLocation((this.currentLocationIndex-1+f.length)%f.length))}),window.addEventListener("resize",()=>{this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)})}async goToLocation(o){if(this.isLoading)return;this.isLoading=!0;const a=f[o];this.currentLocationIndex=o;const e=document.getElementById("location-name"),i=document.getElementById("location-desc");e&&(e.textContent=`‚è≥ Loading ${a.name}...`),i&&(i.textContent=a.region),console.log(`üìç Loading: ${a.name}`),this.spherical.theta=w.degToRad(a.heading-90),this.spherical.phi=w.degToRad(90-(a.pitch||0)),this.camera.lookAt(new g().setFromSpherical(this.spherical));try{const t=await this.getPanoramaId(a.lat,a.lng);if(t){console.log(`üîç Found pano: ${t}`);const s=await this.loadPanoramaTiles(t,"medium"),c=this.panoramaSphere.material;c.map&&c.map.dispose(),c.map=s,c.color.setHex(16777215),c.needsUpdate=!0,console.log(`‚úÖ Loaded panorama for ${a.name}`)}else throw new Error("No pano ID")}catch(t){console.warn("‚ö†Ô∏è Failed to load panorama:",t),this.showFallbackTexture(a)}e&&(e.textContent=a.name),i&&(i.textContent=a.summary||a.desc),this.isLoading=!1}async getPanoramaId(o,a){const e=`https://maps.googleapis.com/maps/api/streetview/metadata?location=${o},${a}&radius=1000&source=outdoor&key=${C}`;try{const t=await(await fetch(e)).json();return t.status==="OK"&&t.pano_id?t.pano_id:(console.warn("Street View metadata:",t.status),null)}catch(i){return console.error("Metadata fetch failed:",i),null}}async loadPanoramaTiles(o,a){const e=I[a],i=document.createElement("canvas");i.width=e.width,i.height=e.height;const t=i.getContext("2d");t.fillStyle="#1A6B7C",t.fillRect(0,0,e.width,e.height);const s=[];for(let r=0;r<e.tilesY;r++)for(let n=0;n<e.tilesX;n++){const u=`https://cbk0.google.com/cbk?output=tile&panoid=${o}&zoom=${e.zoom}&x=${n}&y=${r}`,m=new Promise(d=>{const l=new Image;l.crossOrigin="anonymous",l.onload=()=>{t.drawImage(l,n*v,r*v),d()},l.onerror=()=>{console.warn(`Tile ${n},${r} failed`),d()},l.src=u});s.push(m)}await Promise.all(s);const c=new y(i);return c.colorSpace=E,c}showFallbackTexture(o){const e=A[o.region]?.color||"#2A9D8F",i=document.createElement("canvas");i.width=1024,i.height=512;const t=i.getContext("2d"),s=t.createLinearGradient(0,0,0,512);s.addColorStop(0,"#87CEEB"),s.addColorStop(.5,e),s.addColorStop(1,"#1A4A3A"),t.fillStyle=s,t.fillRect(0,0,1024,512),t.fillStyle="rgba(255,255,255,0.9)",t.font="bold 32px sans-serif",t.textAlign="center",t.fillText(`üìç ${o.name}`,512,220),t.font="18px sans-serif",t.fillStyle="rgba(255,255,255,0.6)",t.fillText("Street View unavailable for this location",512,260),t.fillText("‚Üê ‚Üí to try another location",512,290);const c=new y(i),r=this.panoramaSphere.material;r.map&&r.map.dispose(),r.map=c,r.color.setHex(16777215),r.needsUpdate=!0}render(){this.renderer.render(this.scene,this.camera)}}window.addEventListener("DOMContentLoaded",()=>{try{new R}catch(p){console.error("App error:",p)}});
